# Быстрое решение проблемы с долгой сборкой

## Проблема
Сборка зависает на этапе `npm ci` более 10 минут.

## Решение 1: Использовать упрощенный Dockerfile

Я создал упрощенный `Dockerfile.simple`. Чтобы использовать его:

1. В Dokploy найдите настройки Dockerfile
2. Измените путь к Dockerfile на: `Dockerfile.simple`
3. Или переименуйте файлы:
   - `Dockerfile` → `Dockerfile.old`
   - `Dockerfile.simple` → `Dockerfile`

## Решение 2: Исправить NEXTAUTH_URL

**Важно:** В ваших переменных окружения указано:
```
NEXTAUTH_URL=http://localhost:8000
```

Это неправильно для продакшена! Нужно указать реальный URL вашего сервера:

```
NEXTAUTH_URL=http://ваш-ip-адрес:8000
```

Или если есть домен:
```
NEXTAUTH_URL=https://ваш-домен.com
```

## Решение 3: Проверить ресурсы сервера

Если сервер слабый, сборка может быть очень медленной. Проверьте:

```bash
# Через SSH
free -h  # Проверка RAM
df -h    # Проверка диска
nproc    # Количество CPU ядер
```

## Решение 4: Использовать готовый образ

Если сборка все равно слишком медленная, можно:
1. Собрать образ локально
2. Загрузить в Docker Hub
3. Использовать готовый образ в docker-compose

## Что сделать прямо сейчас

1. **Исправьте NEXTAUTH_URL** в переменных окружения Dokploy:
   ```
   NEXTAUTH_URL=http://ваш-ip:8000
   ```

2. **Попробуйте упрощенный Dockerfile**:
   - Переименуйте `Dockerfile` в `Dockerfile.old`
   - Переименуйте `Dockerfile.simple` в `Dockerfile`
   - Закоммитьте и запушьте
   - Перезапустите деплой

3. **Или отмените текущий деплой и перезапустите** - иногда помогает

## Альтернатива: Сборка без Docker Compose

Если Docker Compose вызывает проблемы, можно использовать обычный Docker деплой в Dokploy (без compose).

---

**Сначала исправьте NEXTAUTH_URL - это критично!**

