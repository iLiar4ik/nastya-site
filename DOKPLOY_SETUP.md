# –ü–æ–¥—Ä–æ–±–Ω–∞—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ –Ω–∞—Å—Ç—Ä–æ–π–∫–µ –Ω–∞ Dokploy

–≠—Ç–æ –ø–æ—à–∞–≥–æ–≤–∞—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –¥–ª—è –Ω–æ–≤–∏—á–∫–æ–≤ –ø–æ –Ω–∞—Å—Ç—Ä–æ–π–∫–µ –ø—Ä–æ–µ–∫—Ç–∞ –Ω–∞ Dokploy.

## –ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è

- ‚úÖ Dokploy —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –Ω–∞ –≤–∞—à–µ–º —Å–µ—Ä–≤–µ—Ä–µ
- ‚úÖ PostgreSQL –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∞ (–Ω–∞ —Ç–æ–º –∂–µ —Å–µ—Ä–≤–µ—Ä–µ –∏–ª–∏ –¥–æ—Å—Ç—É–ø–Ω–∞)
- ‚úÖ Git —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π —Å–æ–∑–¥–∞–Ω –∏ –∫–æ–¥ –∑–∞–ø—É—à–µ–Ω
- ‚úÖ –î–æ—Å—Ç—É–ø –∫ —Å–µ—Ä–≤–µ—Ä—É –ø–æ SSH (–¥–ª—è –Ω–µ–∫–æ—Ç–æ—Ä—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π)

## –®–∞–≥ 1: –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö PostgreSQL

### –ï—Å–ª–∏ PostgreSQL –Ω–∞ —Ç–æ–º –∂–µ —Å–µ—Ä–≤–µ—Ä–µ:

1. –ü–æ–¥–∫–ª—é—á–∏—Ç–µ—Å—å –∫ —Å–µ—Ä–≤–µ—Ä—É –ø–æ SSH
2. –°–æ–∑–¥–∞–π—Ç–µ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö (–µ—Å–ª–∏ –µ—â–µ –Ω–µ —Å–æ–∑–¥–∞–Ω–∞):

```bash
# –ü–æ–¥–∫–ª—é—á–∏—Ç–µ—Å—å –∫ PostgreSQL
sudo -u postgres psql

# –°–æ–∑–¥–∞–π—Ç–µ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö
CREATE DATABASE nastya_site;

# –°–æ–∑–¥–∞–π—Ç–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (–µ—Å–ª–∏ –µ—â–µ –Ω–µ —Å–æ–∑–¥–∞–Ω)
CREATE USER nastya_user WITH PASSWORD '–≤–∞—à_–Ω–∞–¥–µ–∂–Ω—ã–π_–ø–∞—Ä–æ–ª—å';

# –î–∞–π—Ç–µ –ø—Ä–∞–≤–∞
GRANT ALL PRIVILEGES ON DATABASE nastya_site TO nastya_user;

# –í—ã–π–¥–∏—Ç–µ
\q
```

3. –ó–∞–ø–æ–º–Ω–∏—Ç–µ:
   - –ò–º—è –±–∞–∑—ã: `nastya_site`
   - –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å: `nastya_user`
   - –ü–∞—Ä–æ–ª—å: —Ç–æ—Ç, —á—Ç–æ –≤—ã —É–∫–∞–∑–∞–ª–∏

### –ï—Å–ª–∏ PostgreSQL –Ω–∞ –¥—Ä—É–≥–æ–º —Å–µ—Ä–≤–µ—Ä–µ:

–£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ:
- PostgreSQL –¥–æ—Å—Ç—É–ø–µ–Ω —Å —Å–µ—Ä–≤–µ—Ä–∞ Dokploy
- Firewall —Ä–∞–∑—Ä–µ—à–∞–µ—Ç –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –Ω–∞ –ø–æ—Ä—Ç 5432
- –£ –≤–∞—Å –µ—Å—Ç—å —É—á–µ—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –¥–ª—è –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è

## –®–∞–≥ 2: –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Å–µ–∫—Ä–µ—Ç–Ω—ã—Ö –∫–ª—é—á–µ–π

–ü–µ—Ä–µ–¥ –Ω–∞—Å—Ç—Ä–æ–π–∫–æ–π Dokploy —Å–≥–µ–Ω–µ—Ä–∏—Ä—É–π—Ç–µ `NEXTAUTH_SECRET`:

```bash
# –ù–∞ —Å–µ—Ä–≤–µ—Ä–µ –∏–ª–∏ –ª–æ–∫–∞–ª—å–Ω–æ
openssl rand -base64 32
```

–°–∫–æ–ø–∏—Ä—É–π—Ç–µ —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –∫–ª—é—á - –æ–Ω –ø–æ–Ω–∞–¥–æ–±–∏—Ç—Å—è –≤ —à–∞–≥–µ 4.

## –®–∞–≥ 3: –°–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞ –≤ Dokploy

1. –û—Ç–∫—Ä–æ–π—Ç–µ Dokploy –≤ –±—Ä–∞—É–∑–µ—Ä–µ (–æ–±—ã—á–Ω–æ `http://–≤–∞—à-—Å–µ—Ä–≤–µ—Ä:3000`)

2. –í–æ–π–¥–∏—Ç–µ –≤ —Å–∏—Å—Ç–µ–º—É

3. –ù–∞–∂–º–∏—Ç–µ **"New Project"** –∏–ª–∏ **"–°–æ–∑–¥–∞—Ç—å –ø—Ä–æ–µ–∫—Ç"**

4. –ó–∞–ø–æ–ª–Ω–∏—Ç–µ —Ñ–æ—Ä–º—É:
   - **Project Name:** `nastya-site` (–∏–ª–∏ –ª—é–±–æ–µ –¥—Ä—É–≥–æ–µ –∏–º—è)
   - **Type:** –≤—ã–±–µ—Ä–∏—Ç–µ `Git Repository` –∏–ª–∏ `Application`

## –®–∞–≥ 4: –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ Git —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è

### –î–ª—è –ø—É–±–ª–∏—á–Ω–æ–≥–æ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è:

1. **Repository URL:** 
   ```
   https://github.com/–≤–∞—à-username/nastya-site.git
   ```

2. **Branch:** `main` (–∏–ª–∏ `master`)

### –î–ª—è –ø—Ä–∏–≤–∞—Ç–Ω–æ–≥–æ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è:

1. **Repository URL:**
   ```
   https://github.com/–≤–∞—à-username/nastya-site.git
   ```
   –∏–ª–∏ SSH:
   ```
   git@github.com:–≤–∞—à-username/nastya-site.git
   ```

2. **Branch:** `main`

3. **–ù–∞—Å—Ç—Ä–æ–π–∫–∞ –¥–æ—Å—Ç—É–ø–∞:**
   - **–í–∞—Ä–∏–∞–Ω—Ç A (SSH –∫–ª—é—á):**
     - –í –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö Dokploy –¥–æ–±–∞–≤—å—Ç–µ SSH –∫–ª—é—á
     - –°–≥–µ–Ω–µ—Ä–∏—Ä—É–π—Ç–µ –∫–ª—é—á: `ssh-keygen -t ed25519 -C "dokploy"`
     - –î–æ–±–∞–≤—å—Ç–µ –ø—É–±–ª–∏—á–Ω—ã–π –∫–ª—é—á –≤ GitHub (Settings ‚Üí SSH and GPG keys)
   
   - **–í–∞—Ä–∏–∞–Ω—Ç B (Personal Access Token):**
     - –°–æ–∑–¥–∞–π—Ç–µ —Ç–æ–∫–µ–Ω –≤ GitHub (Settings ‚Üí Developer settings ‚Üí Personal access tokens)
     - –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Ç–æ–∫–µ–Ω –≤–º–µ—Å—Ç–æ –ø–∞—Ä–æ–ª—è –ø—Ä–∏ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–∏

## –®–∞–≥ 5: –ù–∞—Å—Ç—Ä–æ–π–∫–∏ —Å–±–æ—Ä–∫–∏

–í –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö –ø—Ä–æ–µ–∫—Ç–∞ –Ω–∞–π–¥–∏—Ç–µ —Ä–∞–∑–¥–µ–ª **"Build Settings"** –∏–ª–∏ **"–ù–∞—Å—Ç—Ä–æ–π–∫–∏ —Å–±–æ—Ä–∫–∏"**:

1. **Build Command:**
   ```bash
   npm install && npm run db:generate && npx prisma db push && npm run build
   ```
   
   –≠—Ç–æ –∫–æ–º–∞–Ω–¥–∞:
   - –£—Å—Ç–∞–Ω–æ–≤–∏—Ç –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
   - –°–≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç Prisma Client
   - –ü—Ä–∏–º–µ–Ω–∏—Ç —Å—Ö–µ–º—É –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
   - –°–æ–±–µ—Ä–µ—Ç Next.js –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ

2. **Start Command:**
   ```bash
   npm start
   ```

3. **Node Version:** `20` (–∏–ª–∏ `18`)

4. **Working Directory:** `.` (—Ç–æ—á–∫–∞, –∫–æ—Ä–µ–Ω—å –ø—Ä–æ–µ–∫—Ç–∞)

5. **Port:** `3000` (–µ—Å–ª–∏ –Ω—É–∂–Ω–æ —É–∫–∞–∑–∞—Ç—å)

## –®–∞–≥ 6: –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è

–í —Ä–∞–∑–¥–µ–ª–µ **"Environment Variables"** –∏–ª–∏ **"–ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è"** –¥–æ–±–∞–≤—å—Ç–µ:

### –û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ:

```
DATABASE_URL=postgresql://nastya_user:–≤–∞—à_–ø–∞—Ä–æ–ª—å@localhost:5432/nastya_site?schema=public
```

**–í–∞–∂–Ω–æ:** –ó–∞–º–µ–Ω–∏—Ç–µ:
- `–≤–∞—à_–ø–∞—Ä–æ–ª—å` - –ø–∞—Ä–æ–ª—å –æ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –ë–î
- `localhost` - –µ—Å–ª–∏ –ë–î –Ω–∞ –¥—Ä—É–≥–æ–º —Å–µ—Ä–≤–µ—Ä–µ, —É–∫–∞–∂–∏—Ç–µ IP –∏–ª–∏ –∞–¥—Ä–µ—Å

```
NEXTAUTH_URL=https://–≤–∞—à-–¥–æ–º–µ–Ω.com
```

**–í–∞–∂–Ω–æ:** 
- –ï—Å–ª–∏ —É –≤–∞—Å –µ—Å—Ç—å –¥–æ–º–µ–Ω: —É–∫–∞–∂–∏—Ç–µ `https://–≤–∞—à-–¥–æ–º–µ–Ω.com`
- –ï—Å–ª–∏ –ø–æ–∫–∞ –Ω–µ—Ç –¥–æ–º–µ–Ω–∞: —É–∫–∞–∂–∏—Ç–µ `http://–≤–∞—à-ip:–ø–æ—Ä—Ç` (–ø–æ—Ä—Ç, –∫–æ—Ç–æ—Ä—ã–π –∏—Å–ø–æ–ª—å–∑—É–µ—Ç Dokploy)
- –ü–æ—Å–ª–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –¥–æ–º–µ–Ω–∞ –æ–±–Ω–æ–≤–∏—Ç–µ —ç—Ç—É –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é

```
NEXTAUTH_SECRET=–≤–∞—à_—Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–π_–∫–ª—é—á_–∏–∑_—à–∞–≥–∞_2
```

```
NODE_ENV=production
```

### –ü—Ä–∏–º–µ—Ä –ø–æ–ª–Ω–æ–≥–æ —Å–ø–∏—Å–∫–∞:

```
DATABASE_URL=postgresql://nastya_user:mypassword123@localhost:5432/nastya_site?schema=public
NEXTAUTH_URL=https://nastya.example.com
NEXTAUTH_SECRET=abc123xyz789...–≤–∞—à_–¥–ª–∏–Ω–Ω—ã–π_–∫–ª—é—á
NODE_ENV=production
```

## –®–∞–≥ 7: –ü–µ—Ä–≤—ã–π –¥–µ–ø–ª–æ–π

1. –°–æ—Ö—Ä–∞–Ω–∏—Ç–µ –≤—Å–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏

2. –ù–∞–∂–º–∏—Ç–µ **"Deploy"** –∏–ª–∏ **"Deploy Now"**

3. –°–ª–µ–¥–∏—Ç–µ –∑–∞ –ª–æ–≥–∞–º–∏ —Å–±–æ—Ä–∫–∏:
   - –î–æ–ª–∂–Ω—ã –ø—Ä–æ–π—Ç–∏: —É—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
   - –ì–µ–Ω–µ—Ä–∞—Ü–∏—è Prisma Client
   - –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ —Å—Ö–µ–º—ã –ë–î
   - –°–±–æ—Ä–∫–∞ Next.js
   - –ó–∞–ø—É—Å–∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

4. –ï—Å–ª–∏ –µ—Å—Ç—å –æ—à–∏–±–∫–∏ - –ø—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ –∏ –∏—Å–ø—Ä–∞–≤—å—Ç–µ

## –®–∞–≥ 8: –°–æ–∑–¥–∞–Ω–∏–µ –ø–µ—Ä–≤–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

–ü–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–≥–æ –¥–µ–ø–ª–æ—è —Å–æ–∑–¥–∞–π—Ç–µ –ø–µ—Ä–≤–æ–≥–æ —É—á–∏—Ç–µ–ª—è:

### –°–ø–æ—Å–æ–± 1: –ß–µ—Ä–µ–∑ —Ç–µ—Ä–º–∏–Ω–∞–ª Dokploy

1. –í Dokploy –Ω–∞–π–¥–∏—Ç–µ –≤–∞—à –ø—Ä–æ–µ–∫—Ç
2. –û—Ç–∫—Ä–æ–π—Ç–µ —Ä–∞–∑–¥–µ–ª **"Terminal"** –∏–ª–∏ **"Console"** (–µ—Å–ª–∏ –¥–æ—Å—Ç—É–ø–Ω–æ)
3. –í—ã–ø–æ–ª–Ω–∏—Ç–µ:
   ```bash
   node create-teacher.js
   ```
4. –í–≤–µ–¥–∏—Ç–µ –¥–∞–Ω–Ω—ã–µ —É—á–∏—Ç–µ–ª—è

### –°–ø–æ—Å–æ–± 2: –ß–µ—Ä–µ–∑ SSH –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ

1. –ü–æ–¥–∫–ª—é—á–∏—Ç–µ—Å—å –∫ —Å–µ—Ä–≤–µ—Ä—É –ø–æ SSH
2. –ù–∞–π–¥–∏—Ç–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è:
   ```bash
   docker ps
   ```
3. –í–æ–π–¥–∏—Ç–µ –≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä:
   ```bash
   docker exec -it <–∏–º—è-–∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞> sh
   ```
4. –í—ã–ø–æ–ª–Ω–∏—Ç–µ:
   ```bash
   node create-teacher.js
   ```

### –°–ø–æ—Å–æ–± 3: –ß–µ—Ä–µ–∑ Prisma Studio

1. –í —Ç–µ—Ä–º–∏–Ω–∞–ª–µ Dokploy –∏–ª–∏ SSH –≤—ã–ø–æ–ª–Ω–∏—Ç–µ:
   ```bash
   docker exec -it <–∏–º—è-–∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞> npx prisma studio
   ```
2. –û—Ç–∫—Ä–æ–π—Ç–µ –≤ –±—Ä–∞—É–∑–µ—Ä–µ (–æ–±—ã—á–Ω–æ `http://localhost:5555`)
3. –°–æ–∑–¥–∞–π—Ç–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤—Ä—É—á–Ω—É—é (–Ω–µ –∑–∞–±—É–¥—å—Ç–µ –∑–∞—Ö–µ—à–∏—Ä–æ–≤–∞—Ç—å –ø–∞—Ä–æ–ª—å!)

## –®–∞–≥ 9: –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏

1. –û—Ç–∫—Ä–æ–π—Ç–µ —Å–∞–π—Ç –≤ –±—Ä–∞—É–∑–µ—Ä–µ (URL –∏–∑ `NEXTAUTH_URL`)

2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ:
   - ‚úÖ –ì–ª–∞–≤–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞ –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç—Å—è
   - ‚úÖ –ù–∞–≤–∏–≥–∞—Ü–∏—è —Ä–∞–±–æ—Ç–∞–µ—Ç
   - ‚úÖ –ú–æ–∂–Ω–æ –≤–æ–π—Ç–∏ –∫–∞–∫ —É—á–∏—Ç–µ–ª—å
   - ‚úÖ –ü–∞–Ω–µ–ª—å —É—á–∏—Ç–µ–ª—è –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç—Å—è

3. –°–æ–∑–¥–∞–π—Ç–µ —Ç–µ—Å—Ç–æ–≤–æ–≥–æ —É—á–µ–Ω–∏–∫–∞ —á–µ—Ä–µ–∑ –ø–∞–Ω–µ–ª—å —É—á–∏—Ç–µ–ª—è

## –®–∞–≥ 10: –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –¥–æ–º–µ–Ω–∞ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

### –ï—Å–ª–∏ —É –≤–∞—Å –µ—Å—Ç—å –¥–æ–º–µ–Ω:

1. **–í Dokploy:**
   - –û—Ç–∫—Ä–æ–π—Ç–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –ø—Ä–æ–µ–∫—Ç–∞
   - –ù–∞–π–¥–∏—Ç–µ —Ä–∞–∑–¥–µ–ª "Domains" –∏–ª–∏ "–î–æ–º–µ–Ω—ã"
   - –î–æ–±–∞–≤—å—Ç–µ –≤–∞—à –¥–æ–º–µ–Ω: `–≤–∞—à-–¥–æ–º–µ–Ω.com`

2. **–í DNS –ø—Ä–æ–≤–∞–π–¥–µ—Ä–µ** (–≥–¥–µ –∫—É–ø–∏–ª–∏ –¥–æ–º–µ–Ω):
   - –°–æ–∑–¥–∞–π—Ç–µ A –∑–∞–ø–∏—Å—å:
     - –ò–º—è: `@` –∏–ª–∏ –æ—Å—Ç–∞–≤—å—Ç–µ –ø—É—Å—Ç—ã–º
     - –ó–Ω–∞—á–µ–Ω–∏–µ: IP –∞–¥—Ä–µ—Å –≤–∞—à–µ–≥–æ —Å–µ—Ä–≤–µ—Ä–∞
   - –ò–ª–∏ CNAME –∑–∞–ø–∏—Å—å:
     - –ò–º—è: `@` –∏–ª–∏ `www`
     - –ó–Ω–∞—á–µ–Ω–∏–µ: –∞–¥—Ä–µ—Å, –∫–æ—Ç–æ—Ä—ã–π –¥–∞–ª Dokploy

3. **–û–±–Ω–æ–≤–∏—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è:**
   - –ò–∑–º–µ–Ω–∏—Ç–µ `NEXTAUTH_URL` –Ω–∞ `https://–≤–∞—à-–¥–æ–º–µ–Ω.com`
   - –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –≤ Dokploy

4. **SSL —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç:**
   - Dokploy –º–æ–∂–µ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å Let's Encrypt
   - –ò–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ Cloudflare –¥–ª—è SSL

## –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞

–ö–æ–≥–¥–∞ –Ω—É–∂–Ω–æ –æ–±–Ω–æ–≤–∏—Ç—å –∫–æ–¥:

1. **–õ–æ–∫–∞–ª—å–Ω–æ:**
   ```bash
   git add .
   git commit -m "–û–ø–∏—Å–∞–Ω–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π"
   git push origin main
   ```

2. **–í Dokploy:**
   - Dokploy –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–±–Ω–∞—Ä—É–∂–∏—Ç –∏–∑–º–µ–Ω–µ–Ω–∏—è
   - –ò–ª–∏ –Ω–∞–∂–º–∏—Ç–µ "Redeploy" –≤—Ä—É—á–Ω—É—é

3. –î–æ–∂–¥–∏—Ç–µ—Å—å –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –ø–µ—Ä–µ—Å–±–æ—Ä–∫–∏

## –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ –ª–æ–≥–∏

### –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤:

1. –í Dokploy –æ—Ç–∫—Ä–æ–π—Ç–µ –ø—Ä–æ–µ–∫—Ç
2. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ —Ä–∞–∑–¥–µ–ª "Logs" –∏–ª–∏ "–õ–æ–≥–∏"
3. –í—ã–±–µ—Ä–∏—Ç–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

### –ü—Ä–æ—Å–º–æ—Ç—Ä —á–µ—Ä–µ–∑ SSH:

```bash
# –õ–æ–≥–∏ Dokploy
docker logs <–∏–º—è-–∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è> -f

# –ò–ª–∏ –µ—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç–µ docker-compose
docker-compose logs -f app
```

## –†–µ–∑–µ—Ä–≤–Ω–æ–µ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ

### –†–µ–∑–µ—Ä–≤–Ω–æ–µ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö:

```bash
# –°–æ–∑–¥–∞–π—Ç–µ –±—ç–∫–∞–ø
pg_dump -U nastya_user nastya_site > backup_$(date +%Y%m%d).sql

# –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ
psql -U nastya_user nastya_site < backup_20240101.sql
```

### –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Ä–µ–∑–µ—Ä–≤–Ω–æ–µ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ:

–°–æ–∑–¥–∞–π—Ç–µ cron –∑–∞–¥–∞—á—É:

```bash
# –†–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ crontab
crontab -e

# –î–æ–±–∞–≤—å—Ç–µ —Å—Ç—Ä–æ–∫—É (–±—ç–∫–∞–ø –∫–∞–∂–¥—ã–π –¥–µ–Ω—å –≤ 2:00)
0 2 * * * pg_dump -U nastya_user nastya_site > /backup/nastya_site_$(date +\%Y\%m\%d).sql
```

## –†–µ—à–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º

### –ü—Ä–æ–±–ª–µ–º–∞: –û—à–∏–±–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ –ë–î

**–†–µ—à–µ–Ω–∏–µ:**
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ `DATABASE_URL` –≤ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è
2. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ PostgreSQL –∑–∞–ø—É—â–µ–Ω: `systemctl status postgresql`
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å –ø–æ—Ä—Ç–∞: `netstat -tulpn | grep 5432`
4. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ firewall: `sudo ufw status`

### –ü—Ä–æ–±–ª–µ–º–∞: –û—à–∏–±–∫–∞ –ø—Ä–∏ —Å–±–æ—Ä–∫–µ

**–†–µ—à–µ–Ω–∏–µ:**
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ –≤ Dokploy
2. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ Node –≤–µ—Ä—Å–∏—è –ø—Ä–∞–≤–∏–ª—å–Ω–∞—è
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –≤—Å–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –≤ `package.json`
4. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –æ—á–∏—Å—Ç–∏—Ç—å –∫—ç—à –∏ –ø–µ—Ä–µ—Å–æ–±—Ä–∞—Ç—å

### –ü—Ä–æ–±–ª–µ–º–∞: NextAuth –æ—à–∏–±–∫–∏

**–†–µ—à–µ–Ω–∏–µ:**
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ `NEXTAUTH_SECRET` - –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –¥–ª–∏–Ω–Ω—ã–º —Å–ª—É—á–∞–π–Ω—ã–º –∫–ª—é—á–æ–º
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ `NEXTAUTH_URL` - –¥–æ–ª–∂–µ–Ω —Å–æ–≤–ø–∞–¥–∞—Ç—å —Å —Ä–µ–∞–ª—å–Ω—ã–º –∞–¥—Ä–µ—Å–æ–º
3. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ URL –Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è —Å `http://` –∏–ª–∏ `https://`

### –ü—Ä–æ–±–ª–µ–º–∞: Prisma –æ—à–∏–±–∫–∏

**–†–µ—à–µ–Ω–∏–µ:**
1. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ `npm run db:generate` –≤ build command
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ `DATABASE_URL` - –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–º
3. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –≤—ã–ø–æ–ª–Ω–∏—Ç—å `npx prisma db push` –≤—Ä—É—á–Ω—É—é –≤ —Ç–µ—Ä–º–∏–Ω–∞–ª–µ

## –ü–æ–ª–µ–∑–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã

```bash
# –°—Ç–∞—Ç—É—Å –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤
docker ps

# –õ–æ–≥–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
docker logs <–∏–º—è-–∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞> -f

# –í–æ–π—Ç–∏ –≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä
docker exec -it <–∏–º—è-–∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞> sh

# –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä
docker restart <–∏–º—è-–∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞>

# –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä
docker stop <–∏–º—è-–∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞>

# –ó–∞–ø—É—Å—Ç–∏—Ç—å –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä
docker start <–∏–º—è-–∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞>
```

## –ß–µ–∫-–ª–∏—Å—Ç –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏

–ü–µ—Ä–µ–¥ —Ç–µ–º –∫–∞–∫ —Å—á–∏—Ç–∞—Ç—å –ø—Ä–æ–µ–∫—Ç –≥–æ—Ç–æ–≤—ã–º, –ø—Ä–æ–≤–µ—Ä—å—Ç–µ:

- [ ] –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö —Å–æ–∑–¥–∞–Ω–∞ –∏ –¥–æ—Å—Ç—É–ø–Ω–∞
- [ ] –ü—Ä–æ–µ–∫—Ç —Å–æ–∑–¥–∞–Ω –≤ Dokploy
- [ ] Git —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π –ø–æ–¥–∫–ª—é—á–µ–Ω
- [ ] Build Command –Ω–∞—Å—Ç—Ä–æ–µ–Ω –ø—Ä–∞–≤–∏–ª—å–Ω–æ
- [ ] –í—Å–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è –¥–æ–±–∞–≤–ª–µ–Ω—ã
- [ ] –ü–µ—Ä–≤—ã–π –¥–µ–ø–ª–æ–π –ø—Ä–æ—à–µ–ª —É—Å–ø–µ—à–Ω–æ
- [ ] –°—Ö–µ–º–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö –ø—Ä–∏–º–µ–Ω–µ–Ω–∞
- [ ] –ü–µ—Ä–≤—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å (—É—á–∏—Ç–µ–ª—å) —Å–æ–∑–¥–∞–Ω
- [ ] –°–∞–π—Ç –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç—Å—è –≤ –±—Ä–∞—É–∑–µ—Ä–µ
- [ ] –í—Ö–æ–¥ —Ä–∞–±–æ—Ç–∞–µ—Ç
- [ ] –ü–∞–Ω–µ–ª—å —É—á–∏—Ç–µ–ª—è –¥–æ—Å—Ç—É–ø–Ω–∞
- [ ] –î–æ–º–µ–Ω –Ω–∞—Å—Ç—Ä–æ–µ–Ω (–µ—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è)
- [ ] SSL —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω (–µ—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è)

## –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –ø–æ–º–æ—â—å

–ï—Å–ª–∏ –≤–æ–∑–Ω–∏–∫–ª–∏ –ø—Ä–æ–±–ª–µ–º—ã:

1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ –≤ Dokploy
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ —á–µ—Ä–µ–∑ SSH: `docker logs <–∫–æ–Ω—Ç–µ–π–Ω–µ—Ä>`
3. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤—Å–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è –ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ
4. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –¥–æ—Å—Ç—É–ø–Ω–∞
5. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –ø–µ—Ä–µ—Å–æ–±—Ä–∞—Ç—å –ø—Ä–æ–µ–∫—Ç

–ì–æ—Ç–æ–≤–æ! –í–∞—à —Å–∞–π—Ç –¥–æ–ª–∂–µ–Ω —Ä–∞–±–æ—Ç–∞—Ç—å –Ω–∞ Dokploy. üéâ

